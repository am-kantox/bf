defmodule BfTest do
  use ExUnit.Case
  doctest Bf

  import ExUnit.CaptureIO

  setup do
    Bf.Dyno.restart()
    Process.sleep(100)
    :ok
  end

  test "map/1" do
    assert "ğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜¸ğŸ±ğŸ˜ºğŸ˜¼ğŸ˜¾ğŸ˜¹ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜¸ğŸ±ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜¾ğŸ˜¹ğŸ±ğŸ˜»" ==
             Bf.map("++>+++++ [<+>-] ++++++++ [<++++++>-] <.")

    assert "++>+++++[<+>-]++++++++[<++++++>-]<." ==
             Bf.unmap("ğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜º ğŸ˜¸ğŸ±ğŸ˜ºğŸ˜¼ğŸ˜¾ğŸ˜¹ ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜º ğŸ˜¸ğŸ±ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜¾ğŸ˜¹ ğŸ±ğŸ˜»")
  end

  test "addition example from Wikipedia" do
    assert "7\n" ==
             capture_io(fn ->
               Bf.run("++>+++++[<+>-]++++++++[<++++++>-]<.")
             end)
  end

  test "Hello world example from Wikipedia" do
    assert "Hello World!\n\n" ==
             capture_io(fn ->
               Bf.run("""
               ++++ ++++
               [>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]
               >>.>---.+++++++..+++.>>.<-.<.+++.------.--------.>>+.>++.
               """)
             end)
  end

  test "Meow (:bf)" do
    assert "Meow\n" ==
             capture_io(fn ->
               Bf.run("""
               ++++ ++++
               [>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]
               >>+++++.>---.++++++++++.++++++++.
               """)
             end)
  end

  test "Meow (:kitty)" do
    assert "Meow\n" ==
             capture_io(fn ->
               Bf.run(
                 """
                 ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜º ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜º
                 ğŸ˜¸ğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜º ğŸ˜¸ğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜¼ğŸ˜ºğŸ±ğŸ±ğŸ±ğŸ±ğŸ˜¾ğŸ˜¹ ğŸ˜¼ğŸ˜ºğŸ˜¼ğŸ˜ºğŸ˜¼ğŸ˜¾ğŸ˜¼ğŸ˜¼ğŸ˜º ğŸ˜¸ğŸ±ğŸ˜¹ ğŸ±ğŸ˜¾ğŸ˜¹
                 ğŸ˜¼ğŸ˜¼ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜»ğŸ˜¼ğŸ˜¾ğŸ˜¾ğŸ˜¾ğŸ˜»ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜»ğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜»
                 """,
                 :kitty
               )
             end)
  end
end
